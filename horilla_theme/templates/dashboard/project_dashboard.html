{% extends 'index.html' %}
{% load static i18n horillafilters mathfilters %}

{% block content %}
<style>
	.oh-info {
		top: 2px !important;
	}
</style>

<div class="grid grid-cols-1 xl:grid-cols-3 md:grid-cols-2 gap-4 mb-4">
	<div
		class="bg-white p-6 rounded-md shadow-card relative cursor-pointer"
		onclick="window.location.href = `{% url 'project-view' %}`"
	>
		<div class="flex items-center gap-4">
			<div class="bg-[#1cba5121] p-3 rounded-md">
				<img
					src="{% static 'horilla_theme/assets/img/icons/projects.svg' %}"
					width="20"
				/>
			</div>
			<div>
				<p class="text-sm">{% trans "Total Projects" %}</p>
				<div class="flex items-center gap-2">
					<p class="text-xl font-bold text-secondary-900">
						{{total_projects}}
					</p>
				</div>
			</div>
		</div>
	</div>
	<div
		class="bg-white p-6 rounded-md shadow-card relative cursor-pointer"
		onclick="window.location.href = `{% url 'project-view' %}?{{request.GET.urlencode}}&status=new`"
	>
		<div class="flex items-center gap-4">
			<div class="bg-[#b71db01f] p-3 rounded-md">
				<img
					src="{% static 'horilla_theme/assets/img/icons/new-project.svg' %}"
					width="20"
				/>
			</div>
			<div>
				<p class="text-sm">{% trans "New Projects" %}</p>
				<div class="flex items-center gap-2">
					<p class="text-xl font-bold text-secondary-900">
						{{new_projects}}
					</p>
				</div>
			</div>
		</div>
	</div>
	<div
		class="bg-white p-6 rounded-md shadow-card relative cursor-pointer"
		onclick="window.location.href = `{% url 'project-view' %}?{{request.GET.urlencode}}&status=in_progress`"
	>
		<div class="flex items-center gap-4">
			<div class="bg-[#ea7f2f2e] p-3 rounded-md">
				<img
					src="{% static 'horilla_theme/assets/img/icons/progress.svg' %}"
					width="20"
				/>
			</div>
			<div>
				<p class="text-sm">{% trans "Projects in progress" %}</p>
				<div class="flex items-center gap-2">
					<p class="text-xl font-bold text-secondary-900">
						{{projects_in_progress}}
					</p>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="grid grid-cols-12 gap-4 mb-4">
	<div
		class="xl:col-span-4 md:col-span-6 col-span-12 bg-white p-6 rounded-md shadow-card"
	>
		<div class="flex justify-between items-center mb-2">
			<h3 class="text-md font-semibold">{% trans "Project Status" %}</h3>
			<span
				class="oh-card-dashboard__title float-end cursor-pointer"
				id="projectStatusForward"
				><ion-icon name="caret-forward"></ion-icon
			></span>
		</div>
		<div class="w-full p-3">
			<div class="relative">
				<canvas id="projectStatusCanvas" class="w-40 h-64"></canvas>
			</div>
			<div
				id="projectLegend"
				class="mt-4 flex justify-center flex-wrap gap-3 text-xs"
			></div>
		</div>
	</div>
	<div
		class="xl:col-span-4 md:col-span-6 col-span-12 bg-white py-6 rounded-md shadow-card"
	>
		<div class="flex justify-between items-center px-5">
			<h3 class="text-md font-semibold px-3">
				{% trans "Projects due in this month" %}
			</h3>
		</div>
		<div class="overflow-hidden overflow-x-auto">
			<div
				hx-get="{% url 'projects-due-in-this-month' %}"
				hx-trigger="load"
			></div>
		</div>
	</div>
	<div
		class="xl:col-span-4 md:col-span-6 col-span-12 bg-white p-6 rounded-md shadow-card"
	>
		<div class="flex justify-between items-center mb-2">
			<h3 class="text-md font-semibold">{% trans "Task Status" %}</h3>
			<span
				class="oh-card-dashboard__title float-end cursor-pointer"
				id="taskStatusForward"
				><ion-icon name="caret-forward"></ion-icon
			></span>
		</div>
		<div class="w-full p-3">
			<div class="relative">
				<canvas id="taskStatusCanvas" class="w-40 h-64"></canvas>
			</div>
			<div
				id="taskLegend"
				class="mt-4 flex justify-center flex-wrap gap-3 text-xs"
			></div>
		</div>
	</div>
</div>
<script src="{% static 'dashboard/projectChart.js' %}"></script>

{% endblock %}
