{% load mathfilters static i18n taskfilters %}

<div class="bg-white p-3 rounded-md shadow-card mb-5">
	<div
		class="flex gap-2 md:gap-0 flex-wrap justify-between items-end mb-5 border-b border-dark-50 pb-3"
	>
		<h3 class="text-sm font-semibold">{{ project }}</h3>

		<div class="flex items-center gap-3">
			{% if perms.pms.change_project or request.user|is_project_manager_or_member:project %}
			<div class="relative dropdown-wrapper">
				<select
					id="status"
					class="px-5 py-2 h-full bg-[white] rounded-md text-xs flex items-center gap-2 border border-primary-500 hover:border-primary-600 transition duration-300"
					name="status"
					title="Status"
					hx-post="{%url 'change-project-status' project.id %}"
					hx-trigger="change"
					hx-target="#reloadMessages"
				>
					<option value="{{project.status}}" selected>
						{% trans project.get_status_display %}
					</option>
					{% for status in project.PROJECT_STATUS %}
						{% if project.status != status.0 %}
							<option value="{{status.0}}">{% trans status.1 %}</option>
						{% endif%}
					{% endfor %}
				</select>
			</div>
			{% else %}
			<div class="text-xs font-medium">
				{{ project.get_status_display }}
			</div>
			{% endif %}

			{% if perms.project.change_project %}
				<a
					onclick="event.preventDefault();event.stopPropagation()"
					data-toggle="oh-modal-toggle"
					data-target="#objectCreateModal"
					hx-get="{% url 'update-project' project.id %}"
					hx-target="#objectCreateModalTarget"
					class="px-2 py-1 bg-primary-300 text-primary-600 rounded-sm w-7 h-7 flex justify-center items-center hover:bg-primary-600 hover:text-white transition duration-300"
					title="{% trans 'Edit' %}"
				>
					<i class="fa-solid fa-pen-to-square"></i>
				</a>
			{% endif %}
		</div>
	</div>

	<div class="grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-3">
		<div class="mb-2 flex gap-5 items-center col-span-6">
			<span class="font-medium text-sm text-[#565E6C] w-20"
				>{% trans "Start Date" %}</span
			>
			<p class="text-sm font-semibold flex items-center gap-5">
				: <span>{{ project.start_date }}</span>
			</p>
		</div>

		<div class="mb-2 flex gap-5 items-center col-span-6">
			<span class="font-medium text-sm text-[#565E6C] w-20"
				>{% trans "End Date" %}</span
			>
			<p class="text-sm font-semibold flex items-center gap-5">
				: <span>{{ project.end_date }}
					<span class="ml-1"
						title="{% if project.end_date == today %}due today{% else %}due in {{ project.end_date|sub:today }}{% endif %}"
					>
						<ion-icon
							class="text-{% if project.end_date < today %}danger {% elif project.end_date == today %}warning {% else %}success{% endif %}"
							name="time-sharp"
						>
						</ion-icon>
					</span>
				</span>
			</p>
		</div>

		<div class="mb-2 flex gap-5 items-center col-span-6">
			<span class="font-medium text-sm text-[#565E6C] w-20"
				>{% trans "Managers" %}</span
			>
			<div class="text-sm font-semibold flex items-center gap-5">
				:
				<ul class="userlist flex flex-wrap gap-1">
					{% for manager in project.managers.all %}
					<li>
						<span>
							<a
								href="{% url 'employee-view-individual' manager.id %}"
								title="{{manager.get_full_name}}"
							>
								<img
									src="{{ manager.get_avatar }}"
									alt="{{ manager }}"
									class="w-6 h-6 rounded-full"
								/>
							</a>
						</span>
					</li>
					{% endfor %}
				</ul>
			</div>
		</div>

		<div class="mb-2 flex gap-5 items-center col-span-6">
			<span class="font-medium text-sm text-[#565E6C] w-20"
				>{% trans "Members" %}</span
			>
			<div class="text-sm font-semibold flex items-center gap-5">
				:
				<ul class="userlist flex flex-wrap gap-1">
					{% for member in project.members.all %}
					<li>
						<span>
							<a
								href="{% url 'employee-view-individual' member.id %}"
								title="{{member.get_full_name}}"
							>
								<img
									src="{{ member.get_avatar }}"
									alt="{{ member }}"
									class="w-6 h-6 rounded-full"
								/>
							</a>
						</span>
					</li>
					{% endfor %}
				</ul>
			</div>
		</div>

		<div class="mb-2 flex gap-5 items-center col-span-12">
			<span class="font-medium text-sm text-[#565E6C] w-20"
				>{% trans "Description" %}</span
			>
			<p class="text-sm font-semibold flex items-center gap-5">
				:
				<span
					>{% if project.description %}
						{{ project.description|linebreaksbr }}
					{% else %}
						{% trans "No Description Available" %}
					{% endif %}</span
				>
			</p>
		</div>
	</div>
</div>
