{% load i18n %}
{% load basefilters %}
{% is_manager_of request.user instance as can_manage %}
{% with can_change=perms.leave.change_leaverequest can_delete=perms.leave.delete_leaverequest can_penalty=perms.base.chanage_penaltyaccounts leave_manager=request.user|is_leave_approval_manager %}
{% if can_change or can_delete or can_penalty or can_manage or leave_manager %}
    <div onclick="event.stopPropagation()">
        <div class="oh-btn-group">

            {# Penalty Button #}
            {% if can_manage or can_penalty or leave_manager %}
                <button data-toggle="oh-modal-toggle" data-target="#penaltyModal" hx-target="#penaltyModalBody"
                    hx-get="{% url 'leave-cut-penalty' instance.id %}" type="button"
                    class="oh-btn oh-btn--danger-outline oh-btn--light-bkg w-100" title="{% trans 'Penalty' %}">
                    <ion-icon name="information-circle-outline"></ion-icon>
                </button>
            {% endif %}

            {# Edit Button #}
            {% if can_manage or can_change or leave_manager %}
                <button class="oh-btn oh-btn--light-bkg w-100 {% if instance.status != 'requested' %}disabled{% endif %}"
                    title="{% trans 'Edit' %}" data-toggle="oh-modal-toggle" data-target="#genericModal"
                    {% if instance.status == 'requested' %}
                        hx-get="{% url 'request-update' instance.id %}?instance_ids={{ instance.ordered_ids }}"
                        hx-target="#genericModalBody"
                    {% endif %}
                    >
                    <ion-icon name="create-outline"></ion-icon>
                </button>
            {% endif %}

            {# Delete Button #}
            {% if can_manage or can_delete or leave_manager %}
            <button
                class="oh-btn oh-btn--danger-outline oh-btn--light-bkg w-100 {% if instance.status != 'requested' %}disabled{% endif %}"
                title="{% trans 'Delete' %}"
                id="delete-link"
                {% if instance.status == 'requested' %}
                    hx-confirm="{% trans 'Are you sure you want to delete?' %}"
                    hx-get="{% url 'request-delete' instance.id %}"
                    hx-target="#leaveRequest"
                {% endif %}
                >
                <ion-icon name="trash-outline"></ion-icon>
            </button>
            {% endif %}

        </div>
    </div>
{% endif %}
{% endwith %}
