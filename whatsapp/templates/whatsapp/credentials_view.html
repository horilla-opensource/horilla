{% extends 'settings.html' %}
{% load i18n horillafilters %}
{% load i18n static  %}
{% block settings %}

<div class="border border-[#ebebeb] rounded-md overflow-hidden mb-5">
    <h2 class="text-sm font-semibold bg-[#f3f3f3] px-4 py-3 text-[#333]">
        {% trans "Whatsapp Integration" %}
    </h2>
    <div class="p-4">
        <div class="grid grid-cols-12 gap-4 myform">
            <div class="col-span-12 lg:col-span-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex space-x-2">
                        <h3 class="text-sm font-medium">{% trans "Enable Whatsapp" %}</h3>
                        <span class="oh-info" title="{% trans 'Enable this to integrate Whatsapp to Horilla.' %}"></span>
                    </div>
                    <label class="toggle-label" for="is_enabled">
                        <input
                            type="checkbox"
                            class="toggle-input"
                            name="is_enabled"
                            id="is_enabled"
                            hx-post="{% url 'enable-integration'%}?app_label=whatsapp"
                            hx-trigger="change"
                            {% if "whatsapp"|integration_installed %} checked {% endif %}
                        />

                        <div class="toggle-switch"></div>
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="px-4">
        {% if "whatsapp"|integration_installed %}
            <div class="oh-inner-sidebar-content">
                <div hx-get="{% url 'whatsapp-credential-nav' %}" hx-trigger="load">
                </div>
            </div>
            <div
                class="oh-checkpoint-badge mb-2"
                id="selectedInstances"
                data-ids="[]"
                data-clicked=""
                style="display: none"
            ></div>
            <div class="oh-wrapper" hx-get="{% url "whatsapp-credential-list" %}?{{request.GET.urlencode}}"
                hx-trigger="load" id="listContainer">
                <div class="animated-background">
                </div>
            </div>
        {% endif %}
    </div>
</div>

<div class="oh-modal" id="whatsappModal" role="dialog" aria-labelledby="whatsappModal"
    aria-hidden="true">
    <div class="oh-modal__dialog" style="max-width: 550px" id="whatsappFormTarget">
        {% include "whatsapp/whatsapp_animation.html" %}
    </div>
</div>

<script src="{% static 'cbv/deleteFunc.js' %}"></script>
<script>
    $(".oh-inner-sidebar__item .oh-accordion").click(function (e) {
		e.stopPropagation();
		$(this).toggleClass('oh-accordion--show')
	});
</script>

{% endblock settings %}
