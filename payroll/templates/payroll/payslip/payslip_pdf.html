{% load humanize %}
{% load static i18n horillafilters %}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap">

<style>
  body {
    margin:0;
    font-family:Inter, Arial, sans-serif;
    color:#111;
  }

  .sheet {
    width:820px;
    margin:40px auto;
    border:2px solid #111;
    padding:24px 28px;
  }

  table {
    width:100%;
    border-collapse:collapse;
    page-break-inside:avoid;
  }

  th, td {
    border:1px solid #d1d5db;
    padding:10px 12px;
    font-size:14px;
  }

  th {
    background:#f3f4f6;
    font-weight:600;
    text-align:left;
  }

  .amount {
    text-align:right;
    white-space:nowrap;
  }

  .blackbar {
    background:#0b0b0b;
    color:#fff;
    text-align:center;
    font-weight:700;
    padding:10px;
    margin:18px 0;
  }

  .card-head {
    background:#0b0b0b;
    color:#fff;
    font-weight:700;
    padding:8px 12px;
  }

  .netpay-box {
    border:2px solid #111;
    padding:10px 16px;
    font-weight:700;
    text-align:right;
  }

  .no-print { margin-top:16px; text-align:right; }

  @media print {
    .no-print { display:none; }
    .sheet { margin:0; border:0; }
  }
</style>
</head>

<body>
<div class="sheet">

<!-- HEADER -->
<table>
  <tr>
    <td style="width:33%; border:none"></td>
    <td style="width:33%;border:none; text-align:center">
      {% if employee.employee_work_info.company_id %}
        <img src="{{ protocol }}://{{ host }}{{ employee.employee_work_info.company_id.icon.url }}" height="60">
      {% else %}
        <img src="{{ protocol }}://{{ host }}{{ company.icon.url }}" height="60">
      {% endif %}
    </td>
    <td style="width:33%;border:none"></td>
  </tr>
  <tr>
    <td colspan="3" style="text-align:center;font-size:13px;padding-top:6px;border:none">
      {% if employee.employee_work_info.company_id %}
        <strong>{{ employee.employee_work_info.company_id }}</strong><br>
        {{ employee.employee_work_info.company_id.address }},
        {{ employee.employee_work_info.company_id.city }},
        {{ employee.employee_work_info.company_id.state }},
        {{ employee.employee_work_info.company_id.country }}
      {% else %}
        <strong>{{ company }}</strong><br>
        {{ company.address }},
        {{ company.city }},
        {{ company.state }},
        {{ company.country }}
      {% endif %}
    </td>
  </tr>
</table>

<div class="blackbar">PAY SLIP</div>

<!-- META -->
<table>
  <tr>
    <td>
      <strong>{% trans "Employee Number" %}</strong><br>{{ employee.badge_id }}
    </td>
    <td>
      <strong>{% trans "Designation" %}</strong><br>
      {{ employee.employee_work_info.job_position_id.job_position }}
    </td>
  </tr>
  <tr>
    <td>
      <strong>{% trans "Employee Name" %}</strong><br>{{ employee }}
    </td>
    <td>
      <strong>{% trans "Bank Acc./Cheque No" %}</strong><br>
      {{ employee.employee_bank_details.account_number }}
    </td>
  </tr>
  <tr>
    <td>
      <strong>{% trans "Process Date" %}</strong><br>
      {{ process_date_25|date:"d F Y" }}
    </td>
    <td>
      <strong>{% trans "Period" %}</strong><br>
      {{ month_start_name }} {% trans "to" %} {{ month_end_name }}
    </td>
  </tr>
</table>

<br>

<table>
<tr>
<td style="width:50%;vertical-align:top;padding-right:6px;border:none;padding-left:0px;">

<div class="card-head">{% trans "EARNINGS" %}</div>
<table>
<tr><td>{% trans "Basic Pay" %}</td>
<td class="amount">{{ basic_pay|floatformat:2|intcomma|currency_symbol_position }}</td></tr>

{% for a in all_allowances %}
<tr><td>{{ a.title }}</td>
<td class="amount">{{ a.amount|floatformat:2|intcomma|currency_symbol_position }}</td></tr>
{% endfor %}

<tr>
<th>{% trans "Total Gross Pay" %}</th>
<th class="amount">{{ gross_pay|floatformat:2|intcomma|currency_symbol_position }}</th>
</tr>
</table>

</td>

<td style="width:50%;vertical-align:top;padding-left:6px;border:none;padding-right: 0px;">

<div class="card-head">{% trans "DEDUCTIONS" %}</div>
<table>
<tr>
    <td>{% trans "Loss of Pay" %}</td>
    <td class="amount">{{ loss_of_pay|floatformat:2|intcomma|currency_symbol_position }}</td>
</tr>
{% for d in all_deductions %}
<tr><td>{{ d.title }}</td>
<td class="amount">{{ d.amount|floatformat:2|intcomma|currency_symbol_position }}</td></tr>
{% endfor %}
<tr>
<th>{% trans "Total Deductions" %}</th>
<th class="amount">{{ total_deductions|floatformat:2|intcomma|currency_symbol_position }}</th>
</tr>
</table>

</td>
</tr>
</table>

<br>

<table>
<tr>
<td style="width:50%;vertical-align:top;padding-right:6px;padding-left: 0;border:none">
<div class="card-head">{% trans "EMPLOYER CONTRIBUTION" %}</div>
<table>
<tr><td>EPF @ 12%</td><td class="amount">{{ employer_epf_amount|floatformat:2|intcomma|currency_symbol_position }}</td></tr>
<tr><td>ETF @ 3%</td><td class="amount">{{ employer_etf_amount|floatformat:2|intcomma|currency_symbol_position }}</td></tr>
</table>
</td>

<td style="width:50%;vertical-align:top;padding-left:6px;padding-right: 0;border:none">
<div class="card-head">{% trans "THIS PERIOD" %}</div>
<table>
<tr><td>{% trans "Total Earnings" %}</td><td class="amount">{{ gross_pay|floatformat:2|intcomma|currency_symbol_position }}</td></tr>
<tr><td>{% trans "Total Deductions" %}</td><td class="amount">{{ total_deductions|floatformat:2|intcomma|currency_symbol_position }}</td></tr>
</table>
</td>
</tr>
</table>

<br>

<table>
<tr>
<td class="card-head">{% trans "NET PAY (Via Bank Transfer)" %}</td>
<td class="netpay-box">{{ net_pay|floatformat:2|intcomma|currency_symbol_position }}</td>
</tr>
</table>

<p style="text-align:center;font-size:13px;color:#6b7280;margin-top:20px">
{% trans "This is a system-generated payslip and does not require a signature." %}
</p>

<div class="no-print">
<button onclick="window.print()">Print / Save as PDF</button>
</div>

</div>
</body>
</html>
